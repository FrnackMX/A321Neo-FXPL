-------------------------------------------------------------------------------
-- A32NX Freeware Project
-- Copyright (C) 2020
-------------------------------------------------------------------------------
-- LICENSE: GNU General Public License v3.0
--
--    This program is free software: you can redistribute it and/or modify
--    it under the terms of the GNU General Public License as published by
--    the Free Software Foundation, either version 3 of the License, or
--    (at your option) any later version.
--
--    Please check the LICENSE file in the root of the repository for further
--    details or check <https://www.gnu.org/licenses/>
-------------------------------------------------------------------------------


include('libs/svm.lua')

local SVM_model = {
    bias = 7.542157348534497e+03,
    alpha = {   -6.607026664195701e+03,
                1.774060017029510e+03,
                -5.136951031979931e+03,
                3.363227187793980e+03,
                2.547441650582793e+03,
                -0.413517655997055e+03,
                -6.607026664195701e+03,
                -6.607026664195701e+03,
                1.305728306036730e+03,
                6.607026664195701e+03,
                6.607026664195701e+03,
                6.607026664195701e+03,
                6.607026664195701e+03,
                0.138706459336516e+03,
                6.607026664195701e+03,
                6.607026664195701e+03,
                -3.007429064144906e+03,
                0.378292075641628e+03,
                -6.607026664195701e+03,
                -2.588309765775458e+03,
                4.243418491235129e+03,
                -4.188868403065024e+03,
                1.457924182969574e+03,
                6.607026664195701e+03,
                2.917232005181866e+03,
                -6.607026664195701e+03,
                -0.199503300745952e+03,
                -3.789428216093142e+03,
                3.548124317093552e+03,
                -0.158014912174529e+03,
                -0.957263383577867e+03,
                -0.903072237610836e+03,
                -0.825154420335249e+03,
                2.623693538530791e+03,
                -0.351176375850538e+03,
                1.333525846098234e+03,
                -1.169727167863552e+03,
                -0.922294670060530e+03,
                -1.938842913438017e+03,
                -0.036543120279751e+03,
                -0.570656930005713e+03,
                -1.909786353596491e+03,
                -0.161485434200898e+03,
                -2.734726064508925e+03,
                -1.582632721715848e+03,
                2.030572647490501e+03,
                0.596864796774623e+03,
                -0.397679963044778e+03,
                -4.265377365260635e+03,
                -0.319000987936364e+03,
                -2.131411119010447e+03,
                -0.814011271914396e+03
    },

    SV = { 
        {-2.464812,1.939712,-1.058480,},
        {-2.470626,1.939669,-1.358323,},
        {-2.474186,1.939625,-2.369201,},
        {-2.473510,1.939625,-0.547351,},
        {-2.473465,1.939625,-0.445670,},
        {-2.472924,1.939625,0.295161,},
        {-2.472834,1.939625,0.387733,},
        {-2.472789,1.939625,0.471845,},
        {-2.474141,1.939625,0.729739,},
        {-2.474141,1.939625,0.730969,},
        {-2.474186,1.939625,0.732253,},
        {-2.472338,1.939625,0.733209,},
        {-2.468958,1.939625,0.734485,},
        {-1.294448,1.935213,0.766377,},
        {-1.292600,1.934558,0.766426,},
        {-1.291744,1.934209,0.766473,},
        {-1.364616,1.773724,0.505221,},
        {-1.506934,1.717375,-0.199723,},
        {-1.521085,1.702786,0.526148,},
        {-1.520950,1.702305,0.536335,},
        {-1.408781,1.595941,0.816111,},
        {-1.118465,1.621626,-1.871185,},
        {-0.944330,1.606512,0.802086,},
        {-0.245312,0.830384,0.928236,},
        {-0.243779,0.828462,0.928609,},
        {-0.353109,0.713799,0.603365,},
        {-0.355723,0.712096,0.555406,},
        {-0.689437,0.594419,-1.610990,},
        {-0.669698,0.324687,0.939450,},
        {-0.579837,0.215004,-0.888278,},
        {-0.580918,0.214741,-0.867544,},
        {-0.211783,-0.059402,0.740043,},
        {-0.208403,-0.059882,0.740062,},
        {0.139597,-0.171357,1.035497,},
        {0.153838,-0.196517,0.400155,},
        {0.634602,-0.958754,1.208718,},
        {0.480206,-1.016151,-1.197141,},
        {0.452265,-1.019515,-0.426219,},
        {0.443838,-1.021743,0.633673,},
        {1.085217,-1.159994,0.429909,},
        {1.085217,-1.160037,0.407378,},
        {1.080395,-1.161522,-0.185042,},
        {1.079899,-1.161610,-0.215135,},
        {0.880392,-1.168468,-1.395066,},
        {1.097475,-1.049655,-1.411685,},
        {0.744293,-0.548719,-1.107428,},
        {0.850784,-0.349969,0.723924,},
        {0.995581,-0.297945,-0.299237,},
        {1.042314,-0.248672,-1.463416,},
        {0.699587,0.070157,-0.605757,},
        {0.629600,0.146555,-1.271376,},
        {0.281149,0.247415,-1.184482,}
    },

    Mu = {0.549013855180128, 0.557388941041612, 74.008090043479285},
    Sg = {0.221896778594015, 0.228931392086134, 23.114551221670112}
}

function predict_engine_thrust(mach, density, N1)
    return predict_svm_gaussian(SVM_model, {mach, density, N1})
end